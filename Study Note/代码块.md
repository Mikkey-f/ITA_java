# 代码块

## 一.介绍

在 Java 里，代码块指的是用花括号 `{}` 括起来的一组代码。它可分为四种类型：静态代码块、实例代码块、构造代码块（与实例代码块本质相同）以及普通代码块。下面为你详细介绍：

### 1. 静态代码块

- **定义**：由 `static` 关键字修饰，在类加载时执行，且仅执行一次。
- **用途**：常用于初始化类的静态变量、加载静态资源等。
- **示例**：

```java
class StaticBlockExample {
    static {
        System.out.println("静态代码块执行");
    }

    public static void main(String[] args) {
        System.out.println("主方法执行");
    }
}
```



在上述代码中，当类 `StaticBlockExample` 被加载时，静态代码块会先执行，接着才会执行 `main` 方法。

### 2. 实例代码块（构造代码块）

- **定义**：没有 `static` 关键字修饰，在每次创建对象时执行，且会在构造方法之前执行。
- **用途**：可用于提取多个构造方法的公共代码。
- **示例**：

```java
class InstanceBlockExample {
    {
        System.out.println("实例代码块执行");
    }

    public InstanceBlockExample() {
        System.out.println("构造方法执行");
    }

    public static void main(String[] args) {
        new InstanceBlockExample();
    }
}
```



此代码在创建 `InstanceBlockExample` 类的对象时，实例代码块会先执行，之后构造方法才会执行。

### 3. 普通代码块

- **定义**：在方法或语句中用花括号 `{}` 括起来的代码块。
- **用途**：用于限制变量的作用域。
- **示例**：

```java
public class NormalBlockExample {
    public static void main(String[] args) {
        {
            int x = 10;
            System.out.println("普通代码块中的 x: " + x);
        }
        // 下面这行代码会报错，因为 x 的作用域仅限于普通代码块内
        // System.out.println(x); 
    }
}
```

在这个示例里，变量 `x` 的作用域仅限于普通代码块内，出了代码块就无法访问。

### 总结

- 静态代码块在类加载时执行，且只执行一次，用于初始化类的静态资源。
- 实例代码块在创建对象时执行，且**在构造方法之前执行**，可提取构造方法的公共代码。
- 普通代码块用于限制变量的作用域，让代码的逻辑更清晰。



![image-20250506193827659](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250506193827659.png)





## 二.作用

![image-20250506194755194](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250506194755194.png)



## 三.细节

![](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250506201414037.png)



```java
package codeblock_.detail;

public class dt01 {
    public static void main(String[] args) {
        //创立对象示例时加载
        AA aa = new AA();
        //创建子类对象时，父类也会被加载,而且父类先被加载
        BB bb = new BB();
        //使用类的静态成员时，类会被加载，
        System.out.println(Cat.n);
          CC cc = new CC();
          CC cc1=new CC();
        //静态代码块只被执行了一次
        //动态代码块每创建一个对象才执行一次，和类加载与否没有关系
        System.out.println(CC.c);//静态代码块被执行
    }
}

class CC{
    public static int c=100;
    static {
        System.out.println("CC的静态代码块被执行。。。。。");
    }
    {
        System.out.println("CC的动态代码块被执行。。。。。");
    }
}
class AA{
    static {
        System.out.println("AA的静态代码块被执行。。。");//1
    }
}
class BB extends AA{
    static {
        System.out.println("BB的静态代码块被执行。。。。。");//2
    }
}
class Cat extends Animal{

    public static int n=999;

    static {
        System.out.println("Cat的静态代码块被执行。。。。。");
    }
}
class Animal{
    static {
        System.out.println("Animal的静态代码块被执行。。。。。");
    }
}
```

执行结果：

AA的静态代码块被执行。。。
BB的静态代码块被执行。。。。。
Animal的静态代码块被执行。。。。。
Cat的静态代码块被执行。。。。。
999
CC的静态代码块被执行。。。。。
CC的动态代码块被执行。。。。。
CC的动态代码块被执行。。。。。
100



![image-20250507152453270](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250507152453270.png)

```java
package codeblock_.detail;

public class dt02 {
    public static void main(String[] args) {
        A a = new A();
    }
}
class A{
    public int n2= getN2();
    private static int n1=getN1();
    public A(){
        System.out.println("无参构造器被调用");
    }

    public int getN2(){
        System.out.println("getN2()被调用。。。。");
        return 200;
    }
    {
        System.out.println("普通代码块。。。。");
    }
    static {
        System.out.println("A 静态代码块01");
    }
    public static int getN1(){
        System.out.println("getN1被调用。。。。");
        return 100;
    }
}

getN1被调用。。。。
A 静态代码块01
getN2()被调用。。。。
普通代码块。。。。
无参构造器被调用
```



![image-20250507154820497](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250507154820497.png)

```java
package codeblock_.detail;

public class dt03 {
    public static void main(String[] args) {
        new BBB();

    }
}
class AAA{
    {
        System.out.println("AAA的普通代码块");
    }
    public AAA() {
        //(1)super()
        //(2)调用本类普通代码块
        System.out.println("AAA的AAA()构造器被调用");
    }
}
class BBB extends AAA{
    {
        System.out.println("BBB的普通代码块");
    }

    public BBB() {
        //(1)super()
        //(2)调用本类普通代码块
        System.out.println("BBB()构造器被调用");
    }
}
/*输出：
    AAA的普通代码块
    AAA的AAA()构造器被调用
    BBB的普通代码块
    BBB()构造器被调用
*/
```



![](C:\Users\24709\AppData\Roaming\Typora\typora-user-images\image-20250507155234745.png)